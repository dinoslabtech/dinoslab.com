---
import "@/styles/global.css";
import Header from "@/components/Header";
import Hero from "@/components/Hero";
import Features from "@/components/Features";
import CTASection from "@/components/CTASection";
import Footer from "@/components/Footer.astro";
import { getCollection } from "astro:content";
import {
  Card,
  CardContent,
  CardDescription,
  CardHeader,
  CardTitle,
} from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import "@/styles/global.css";

const blogPosts = await getCollection("blog");
const sortedPosts = blogPosts.sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<html lang="it">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>Dinoslab - Innovazione Digitale</title>
    <meta
      name="description"
      content="Trasformiamo le tue idee in soluzioni digitali innovative con tecnologie all'avanguardia."
    />
  </head>
  <body class="min-h-screen">
    <Header client:load />
    <Hero client:load />
    <main class="container mx-auto px-4 py-16">
      <div class="max-w-4xl mx-auto">
        <div class="mb-12 text-center">
          <h1 class="text-4xl font-bold tracking-tight mb-4">Blog</h1>
          <p class="text-xl text-[hsl(var(--color-muted-foreground))]">
            Approfondimenti, guide e novità dal mondo dello sviluppo
          </p>
        </div>

        <div class="grid gap-8 md:grid-cols-2">
          {
            sortedPosts.map((post) => (
              <a href={`/blog/${post.slug}`} class="group">
                <Card client:load>
                  <CardHeader>
                    <div class="flex flex-wrap gap-2 mb-2">
                      {post.data.tags.map((tag: string) => (
                        <Badge client:load variant="secondary">
                          {tag}
                        </Badge>
                      ))}
                    </div>
                    <CardTitle class="group-hover:text-[hsl(var(--color-primary))] transition-colors">
                      {post.data.title}
                    </CardTitle>
                    <CardDescription>{post.data.description}</CardDescription>
                  </CardHeader>
                  <CardContent>
                    <div class="flex items-center gap-4 text-sm text-[hsl(var(--color-muted-foreground))]">
                      <span>{post.data.author}</span>
                      <span>•</span>
                      <time datetime={post.data.pubDate.toISOString()}>
                        {post.data.pubDate.toLocaleDateString("it-IT", {
                          year: "numeric",
                          month: "long",
                          day: "numeric",
                        })}
                      </time>
                    </div>
                  </CardContent>
                </Card>
              </a>
            ))
          }
        </div>
      </div>
    </main>
    <Features client:load />
    <CTASection client:load />
    <Footer />
  </body>
</html>
